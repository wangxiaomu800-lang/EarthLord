# 🚀 Supabase 数据库快速配置指南

## 📋 当前状态

✅ Supabase 客户端已配置
✅ Migration SQL 文件已创建
❌ **数据库表尚未创建（需要你执行以下步骤）**

---

## 🎯 执行 SQL Migration（5 分钟）

### 步骤 1: 打开 Supabase Dashboard

在浏览器中访问：
```
https://vuqfufnrxzsmkzmhtuhw.supabase.co
```

或者访问：https://supabase.com/dashboard 然后选择你的项目

### 步骤 2: 进入 SQL Editor

1. 在左侧菜单中点击 **SQL Editor** 图标（或搜索 "SQL"）
2. 点击右上角的 **New Query** 按钮创建新查询

### 步骤 3: 复制 SQL 代码

1. 打开文件：`supabase/migrations/20251226_create_core_tables.sql`
2. **全选并复制**整个文件内容（Command + A，然后 Command + C）

### 步骤 4: 执行 SQL

1. 将复制的内容**粘贴**到 SQL Editor 中
2. 点击右下角的 **Run** 按钮（或按 Command + Enter）
3. 等待执行完成（应该会显示 "Success" 或成功信息）

### 步骤 5: 验证结果

**方法 1: 在 Supabase Dashboard 中检查**
1. 点击左侧的 **Table Editor**
2. 应该能看到 3 个新表：
   - ✅ profiles
   - ✅ territories
   - ✅ pois

**方法 2: 使用应用测试**
1. 在 EarthLord 应用中进入"更多"页面
2. 点击"Supabase 连接测试"
3. 点击"测试连接"按钮
4. 应该显示：
   ```
   ✅ profiles 表存在！
   ✅ 数据库配置完成！
   🎉 恭喜！Supabase 已完全配置成功！
   ```

---

## ❓ 常见问题

### Q: 执行 SQL 时出现错误怎么办？

**错误：`permission denied`**
- 确保你已登录正确的 Supabase 账号
- 确保你有项目的管理员权限

**错误：`table already exists`**
- 表已经创建过了，这是正常的
- 可以直接进行验证步骤

**错误：`syntax error`**
- 确保复制了完整的 SQL 文件内容
- 检查是否有遗漏的分号或括号

### Q: 我不确定是否执行成功？

在 SQL Editor 中运行以下查询来检查：

```sql
-- 检查表是否存在
SELECT table_name
FROM information_schema.tables
WHERE table_schema = 'public'
AND table_name IN ('profiles', 'territories', 'pois');

-- 应该返回 3 行结果
```

### Q: 我想重新开始怎么办？

如果需要删除所有表并重新创建，在 SQL Editor 中运行：

```sql
-- ⚠️ 警告：这会删除所有数据！
DROP TABLE IF EXISTS public.pois CASCADE;
DROP TABLE IF EXISTS public.territories CASCADE;
DROP TABLE IF EXISTS public.profiles CASCADE;
DROP TYPE IF EXISTS poi_type CASCADE;

-- 然后重新执行 migration 文件
```

---

## 🎉 完成后

数据库配置完成后，你可以开始：

1. ✅ 实现用户注册和登录
2. ✅ 开发领地绘制功能
3. ✅ 实现 POI 发现功能
4. ✅ 构建游戏核心玩法

---

## 📚 相关文档

- **完整说明**: `supabase/README.md`
- **Migration 文件**: `supabase/migrations/20251226_create_core_tables.sql`
- **Supabase 文档**: https://supabase.com/docs
